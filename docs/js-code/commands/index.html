<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  <head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PH2TVNW');</script>
    <!-- End Google Tag Manager -->
    <!-- azing recipe embed resizer -->
    <script src="https://cdn.azing.org/e/1/embed.js"></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>CMS Commands in JavaScript | 2sxc 16 / EAV 16 (Archive) </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="CMS Commands in JavaScript | 2sxc 16 / EAV 16 (Archive) ">
    <meta name="generator" content="docfx ">
  
    <link rel="shortcut icon" href="../../assets/favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
  
  <meta property="docfx:rel" content="../../">
  <meta property="docfx:newtab" content="true">

    <!-- Enable lightboxes on all images using https://github.com/roel4ez/docfx-lightbox-plugin -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.13/featherlight.min.css" type="text/css" rel="stylesheet">

    <!-- overwrite the built in highlightJs with a newer version -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/default.min.css">

    <!-- fancybox -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../assets/logos/vcurrent/50.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>

                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../basics/index.html" title="Basics">Basics</a>
                      </li>
                      <li>
                          <a href="../../abyss/index.html" title="Abyss">Abyss</a>
                      </li>
                      <li>
                          <a href="../../web-api/index.html" title="Web APIs">Web APIs</a>
                      </li>
                      <li>
                          <a href="../../net-code/index.html" title="C# &amp; Razor">C# &amp; Razor</a>
                      </li>
                      <li>
                          <a href="../../api/dot-net/index.html" title=".net API">.net API</a>
                      </li>
                      <li class="active">
                          <a href="../../js-code/index.html" title="JS &amp; TS API">JS &amp; TS API</a>
                      </li>
                </ul>            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="xxx-breadcrumb">
            <a class="navbar-right version-button" style="padding: 10px 0 0 0;" href="https://go.2sxc.org/docs-versions" target="_blank" title="archive 🔒">
              v16 🔒 <span class="glyphicon glyphicon-menu-down"></span>
            </a>
            <div id="breadcrumb">
              <ul class="breadcrumb">
                <li></li>
              </ul>
            </div>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="JsCode.Commands.Index">
<h1 id="cms-commands-in-javascript">CMS Commands in JavaScript</h1>

<div class="float-right context-box-summary highlight-max" width="400px">
  <div class="fancybox-auto svg-highlight" style="width: 100%">
<svg version="1.1" baseprofile="full" viewbox="0 0 3229 2529" xmlns="http://www.w3.org/2000/svg">
  <image href="../../basics/stack/assets/stack-detailed.png" x="0" y="0" height="100%" width="100%"></image>
  <!-- Data Highlights -->
  <rect class="svg-highlight prepared data-all" x="0%" y="82%" width="84%" height="18%"></rect>
  <rect class="svg-highlight prepared data-data" x="19%" y="82%" width="64%" height="18%"></rect>
  <rect class="svg-highlight prepared data-assets-all" x="3%" y="82%" width="33%" height="18%"></rect>
  <rect class="svg-highlight prepared data-assets-app" x="3%" y="82%" width="17%" height="10%"></rect>
  <rect class="svg-highlight prepared data-assets-entities" x="18.5%" y="82%" width="17%" height="10%"></rect>
  <rect class="svg-highlight prepared data-configuration" x="3%" y="93%" width="17%" height="6.5%"></rect>
  <rect class="svg-highlight prepared data-entities" x="34%" y="82%" width="33%" height="10.5%"></rect>
  <rect class="svg-highlight prepared data-content-types" x="34%" y="89%" width="33%" height="10%"></rect>
  <rect class="svg-highlight prepared data-content-types-app" x="34%" y="89%" width="17.5%" height="10%"></rect>
  <rect class="svg-highlight prepared data-content-types-global" x="50%" y="89%" width="17%" height="10%"></rect>
  <rect class="svg-highlight prepared data-external" x="65.5%" y="82%" width="17%" height="10.5%"></rect>
  <!-- ADAM -->
  <rect class="svg-highlight prepared adam" x="18.5%" y="89%" width="17%" height="8%"></rect>
  <!-- Server -->
  <rect class="svg-highlight prepared server-all" x="0%" y="41%" width="84%" height="38%"></rect>
  <!-- Prepare -->
  <rect class="svg-highlight prepared prepare-all" x="0%" y="61%" width="84%" height="18%"></rect>
  <rect class="svg-highlight prepared query" x="44.5%" y="61%" width="34%" height="18%"></rect>
  <rect class="svg-highlight prepared query-engine" x="44.5%" y="70%" width="34%" height="7%"></rect>
  <rect class="svg-highlight prepared query-built-in" x="44.5%" y="62.5%" width="18%" height="11%"></rect>
  <rect class="svg-highlight prepared query-app" x="60.5%" y="62.5%" width="17%" height="11%"></rect>
  <rect class="svg-highlight prepared query-datasource" x="71%" y="70%" width="7%" height="7%"></rect>
  <rect class="svg-highlight prepared query-params" x="65%" y="70%" width="10%" height="7%"></rect>
  <!-- Data Source -->
  <rect class="svg-highlight prepared datasource" x="86%" y="51%" width="13%" height="16%"></rect>
  <rect class="svg-highlight prepared datasource-custom" x="87.5%" y="54.5%" width="12%" height="6%"></rect>
  <rect class="svg-highlight prepared datasource-built-in" x="87.5%" y="59%" width="12%" height="7%"></rect>
  <rect class="svg-highlight prepared lookup" x="86%" y="66%" width="13%" height="15%"></rect>
  <rect class="svg-highlight prepared lookup-engine" x="87.5%" y="69%" width="12%" height="6%"></rect>
  <rect class="svg-highlight prepared lookup-sources" x="87.5%" y="73%" width="12%" height="7%"></rect>
  <!-- Optimzers -->
  <rect class="svg-highlight prepared asset-optimizer" x="3%" y="49.5%" width="13.5%" height="8%"></rect>
  <rect class="svg-highlight prepared image-resizer" x="15%" y="30%" width="17%" height="34%"></rect>
  <!-- Process / Awesomize -->
  <rect class="svg-highlight prepared process-all" x="0%" y="41%" width="84%" height="18%"></rect>
  <rect class="svg-highlight prepared process-cs" x="34%" y="41%" width="33%" height="18%"></rect>
  <rect class="svg-highlight prepared process-razor" x="34.3%" y="42%" width="17%" height="15%"></rect>
  <rect class="svg-highlight prepared process-razor-app" x="34.3%" y="42%" width="17%" height="10%"></rect>
  <rect class="svg-highlight prepared process-razor-engine" x="34.3%" y="50%" width="17%" height="7%"></rect>
  <rect class="svg-highlight prepared process-apis" x="50%" y="42%" width="34%" height="15%"></rect>
  <rect class="svg-highlight prepared process-web-api" x="50%" y="42%" width="17%" height="15%"></rect>
  <rect class="svg-highlight prepared process-web-api-app" x="50%" y="42%" width="17%" height="10%"></rect>
  <rect class="svg-highlight prepared process-web-api-engine" x="50%" y="50%" width="17%" height="7%"></rect>
  <rect class="svg-highlight prepared process-libraries" x="47%" y="47%" width="7%" height="7%"></rect>
  <rect class="svg-highlight prepared process-headless" x="65.5%" y="49.5%" width="17%" height="7%"></rect>
  <!-- Libraries -->
  <rect class="svg-highlight prepared libraries" x="86%" y="38%" width="13%" height="15%"></rect>
  <rect class="svg-highlight prepared libraries-app" x="87.5%" y="41%" width="12%" height="6.5%"></rect>
  <rect class="svg-highlight prepared libraries-built-in" x="87.5%" y="46%" width="12%" height="6%"></rect>
  <!-- data formats -->
  <rect class="svg-highlight prepared format-json-custom" x="50%" y="32%" width="17%" height="14%"></rect>
  <rect class="svg-highlight prepared format-json-headless" x="65.5%" y="32%" width="17%" height="21%"></rect>
  <rect class="svg-highlight prepared format-json-edit" x="74%" y="30%" width="19%" height="23%"></rect>
  <!-- Browser -->
  <rect class="svg-highlight prepared browser-all" x="0%" y="0%" width="100%" height="34%"></rect>
  <rect class="svg-highlight prepared browser-show" x="0%" y="0%" width="50%" height="34%"></rect>
  <rect class="svg-highlight prepared browser-interact-edit" x="47%" y="0%" width="37%" height="34%"></rect>
  <rect class="svg-highlight prepared browser-interact" x="47%" y="0%" width="20.5%" height="34%"></rect>
  <rect class="svg-highlight prepared browser-edit" x="64%" y="0%" width="20.5%" height="34%"></rect>
  <rect class="svg-highlight prepared browser-edit-ui" x="81.5%" y="0%" width="18%" height="34%"></rect>
  <!-- Frameworks -->
  <rect class="svg-highlight prepared frameworks-browser" x="0%" y="0%" width="17.5%" height="34%"></rect>
  <rect class="svg-highlight prepared frameworks-CSS" x="0%" y="3%" width="17.5%" height="12%"></rect>
  <rect class="svg-highlight prepared frameworks-js" x="0%" y="12%" width="17.5%" height="12%"></rect>
  <rect class="svg-highlight prepared frameworks-spa" x="0%" y="21%" width="17.5%" height="12%"></rect>
  <!-- App show parts -->
  <rect class="svg-highlight prepared show-html" x="15.8%" y="3%" width="17.5%" height="12%"></rect>
  <rect class="svg-highlight prepared show-js" x="15.8%" y="12%" width="17.5%" height="12%"></rect>
  <rect class="svg-highlight prepared show-spa" x="15.8%" y="21%" width="17.5%" height="12%"></rect>
  <!-- Interact parts -->
  <rect class="svg-highlight prepared interact-mobile" x="48.5%" y="3%" width="17.5%" height="12%"></rect>
  <rect class="svg-highlight prepared interact-2sxc" x="48.5%" y="12%" width="17.5%" height="12%"></rect>
  <!-- Edit parts -->
  <rect class="svg-highlight prepared edit-auto" x="65.5%" y="3%" width="17.5%" height="12%"></rect>
  <rect class="svg-highlight prepared edit-custom" x="65.5%" y="12%" width="17.5%" height="12%"></rect>
  <!-- Edit UI parts -->
  <rect class="svg-highlight prepared edit-ui" x="82.5%" y="3%" width="17.5%" height="18%"></rect>
  <rect class="svg-highlight prepared edit-ui-custom" x="82.5%" y="20%" width="17.5%" height="12%"></rect>
  <!-- SPA parts -->
  <rect class="svg-highlight prepared spa-all" x="0%" y="21%" width="83%" height="12%"></rect>
  <rect class="svg-highlight prepared spa-2sxc-js" x="31.5%" y="21%" width="52%" height="12%"></rect>
  <!-- Custom highlight boxes - can be controlled by in-page CSS -->
  <rect class="svg-highlight highlight1"></rect>
  <rect class="svg-highlight highlight2"></rect>
  <rect class="svg-highlight highlight3"></rect>
  <rect class="svg-highlight highlight4"></rect>
  <rect class="svg-highlight highlight5"></rect>
</svg>
  </div>
  <div class="overlay-description">
<p>you are here (click to zoom) - discover the <a class="xref" href="../../basics/index.html">stack</a></p>
  </div>
</div>
<style>.context-box-summary .edit-custom { visibility: visible; } </style>
<p>Whenever you press a button in the edit-ui, a edit-command is handled by the javascript layer. These commands  are things like:</p>
<ul>
<li><code>edit</code> an item on the screen</li>
<li>open the <code>layout</code>-picker dialog for a content-block</li>
</ul>
<p>Each command needs 3 things</p>
<ol>
<li>a short <a class="xref" href="../../api/js/CommandNames.html#Api_Js_SxcJs_CommandNames">CommandName</a> like <code>new</code></li>
<li><strong>parameters</strong> <code>entityId</code> which differ for each command</li>
<li>a context - usually the current module</li>
</ol>
<p>It always <a href="#returned-promise">returns a promise</a>.</p>
<div style="background: #0088F444; overflow: auto">
  <img src="../../shared/tutorials/assets/razor.png" width="200px" style="padding-right: 20px; float: left">
  <h2> Discover More in the Razor Tutorials </h2>
<p>We have an rich series of <a class="xref" href="https://2sxc.org/dnn-tutorials/en/razor">Razor tutorials</a>. You should really check them out 👍.</p>
</div>
<h2 id="run-commands-and-parameters">Run Commands and Parameters</h2>
<p>Two commands in the 2sxc APIs allow running CMS commands</p>
<ul>
<li><code>$2sxc.cms.run(params: RunParamsWithContext)</code><br>
This is the <code>run</code> on the <a class="xref" href="../../api/js/SxcGlobalCms.html#Api_Js_SxcJs_SxcGlobalCms">Global Cms object</a></li>
<li><code>sxc.cms.run(params: RunParams)</code><br>
This is the <code>run</code> on the <a class="xref" href="../../api/js/SxcCms.html#Api_Js_SxcJs_SxcCms">Instance Cms object</a></li>
</ul>
<p>Both of these commands will run a CMS command with parameters.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>There are some possibilities for confusion which you should be aware of.</p>
<p>The <code>$2sxc.cms.run(...)</code> has a few <a class="xref" href="../2sxc-api/2sxc/obsolete/2sxc.cms-v9.html">old overloads</a> with other parameters.
We plan to discontinue these, as it had to do some magic to figure out what is what.
So even if you find such code, please use the method described here.</p>
<p>Read more: <a class="xref" href="run-variations.html">Various Run Commands</a></p>
</div>
<h2 id="requirements-and-prerequisites">Requirements and Prerequisites</h2>
<p>For this to work, the CMS JavaScripts must be loaded.
This is done automatically or manually.</p>
<ol>
<li>If your user is an admin/editor, this happens automatically.</li>
<li>If your user is not defined as an editor, but should still have these commands (possibly because the Content-Type allows editing for this user), you'll need to activate it manually.</li>
</ol>
<p>To activate these features manually just use the <a class="xref" href="../../net-code/razor/services/page-service.html">IPageService</a> and activate <code>2sxc.JsCms</code>.</p>
<h2 id="how-to-use-v1303">How to use (v13.03)</h2>
<p>Simple example:</p>
<pre><code class="lang-razor">@{
  // enable editing for all users
  GetService&lt;ToSic.Sxc.Services.IPageService&gt;().Activate(&quot;2sxc.JsCms&quot;);
}

&lt;script&gt;
  // Run the command and handle the returned promise
  // This uses the Instance object retrieved using $2sxc(tag)
  function addProject(tag) {
    $2sxc(tag).cms.run({ action: &quot;new&quot;, params: { contentType: &quot;Project&quot;} })
      .then(function () {
        alert(&quot;Thanks - we'll review your entry and publish it.&quot;)
      });
  }

  // This is the alternate way to write the code, using the Global object
  function addProjectAlternative(tag) {
    $2sxc.cms.run({ tag: tag, action: &quot;new&quot;, params: { contentType: &quot;Project&quot;}})
      .then(function () {
        alert(&quot;Thanks - we'll review your entry and publish it.&quot;)
      });
  }&lt;/script&gt;

&lt;span onclick='window.addProject(this)'&gt;
  add your project
&lt;/span&gt;

</code></pre>
<ol>
<li>the <code>tag</code> is an HTML tag in the DOM, which is used to look up the context automatically (see <a class="xref" href="../../basics/edit/edit-ux/context.html">edit-context</a>)</li>
<li>the <code>action</code> is the verb for the <a class="xref" href="index.html">cms-command</a> to run</li>
<li>the <code>params</code> contains additional parameters for that command</li>
</ol>
<h2 id="returned-promise">Returned Promise</h2>
<p>The <code>run</code> always returns a promise.
As you can see in the sample above, this lets you show a specific message or do other things after the command has run.</p>
<p>To handle special cases like prevent a page-refresh or to do custom JS actions at certain points, check out the <a class="xref" href="../toolbars/workflows.html">Workflows</a>.</p>
<h2 id="runparams-and-runparamswithcontext">RunParams and RunParamsWithContext</h2>
<p>Both commands take one object with named properties, to help keep the API stable across changes.</p>
<div class="TIP">
<h5>Tip</h5>
<p>The Instance call on <code>sxc.cms.run(...)</code> uses the <a class="xref" href="../../api/js/RunParams.html#Api_Js_SxcJs_RunParams">RunParams</a>.
It will throw an error if a <code>context</code> is also provided, because that indicates
you're doing something wrong.</p>
<p>On the other hand the Global call on the <code>$2sxc.cms.run(...)</code> explicitly needs <a class="xref" href="../../api/js/RunParamsWithContext.html#Api_Js_SxcJs_RunParamsWithContext">RunParamsWithContext</a>
either <code>tag</code> or <code>context</code>, and will throw an error if both are missing.</p>
</div>
<h2 id="command-workflow-example">Command Workflow Example</h2>
<p>Commands can be called with additional workflow steps which are processed before or after certain steps. For example, you can prevent the page from refreshing - to trigger an own JS-Reload or something.</p>
<p>👉 Read more about <a class="xref" href="workflow.html">Workflows and Steps</a>.</p>
<h2 id="command-with-custom-code">Command With Custom Code</h2>
<p>There is a command called <strong>custom</strong> which is meant to be used for this. Check out the example on <a class="xref" href="../../api/js/CommandCodeParams.html#Api_Js_SxcJs_CommandCodeParams">Custom Code</a></p>
<h2 id="all-commands--parameters">All Commands &amp; Parameters</h2>
<p>👉🏼 <a class="xref" href="../../api/js/CommandNames.html#Api_Js_SxcJs_CommandNames">CommandNames</a></p>
<p>Details about some specific commands:</p>
<ol>
<li><a class="xref" href="../../api/js/CommandDataParams.html#Api_Js_SxcJs_CommandDataParams">ContentItems with Filters</a></li>
<li><a class="xref" href="../../api/js/CommandDeleteParams.html#Api_Js_SxcJs_CommandDeleteParams">Delete</a></li>
<li><a class="xref" href="../../api/js/CommandCodeParams.html#Api_Js_SxcJs_CommandCodeParams">Custom Code</a></li>
</ol>
<h2 id="demo-app-and-further-links">Demo App and further links</h2>
<p>You should find some code examples in this demo App</p>
<ul>
<li><a href="http://2sxc.org/en/apps/app/tutorial-for-the-javascript-apis-and-custom-toolbars">JS Manage / Toolbar API Tutorial App</a></li>
<li>Blog post about <a href="http://2sxc.org/en/blog/post/create-links-which-run-cms-commands-new-2sxc-8-6">Calling commands from links</a></li>
</ul>
<div style="background: #0088F444; overflow: auto">
  <img src="../../shared/tutorials/assets/razor.png" width="200px" style="padding-right: 20px; float: left">
  <h2> Discover More in the Razor Tutorials </h2>
<p>We have an rich series of <a class="xref" href="https://2sxc.org/dnn-tutorials/en/razor">Razor tutorials</a>. You should really check them out 👍.</p>
</div>
<h2 id="history">History</h2>
<ol>
<li>Global <code>$2sxc.cms.run(...)</code> introduced in 2sxc 09.30</li>
<li>Enhanced with <code>RunParams</code> in 2sxc 12.10 to support registering <code>workflows</code></li>
<li>Use with <code>context</code> instead of <code>tag</code> added in v13.03</li>
<li>Instance version added in v13.03</li>
</ol>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>

    <!-- override the built-in highlightjs with a newer version -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="../../styles/cshtml-razor.js"></script>
    <script>
        hljs.registerLanguage('cshtml-razor', window.hljsDefineCshtmlRazor);
        hljs.highlightAll();
    </script>

    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.13/featherlight.min.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" src="../../styles/2sxc-scripts.js"></script>

    <!-- fancybox -->
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
  </body>
</html>
